# (c) Space Exodus Team - MPL-2.0 with CLA
# Authors: Lokilife

- type: entity
  id: SpaceLeviathan
  parent: [ SimpleSpaceMobBase, FlyingMobBase, MobCombat ]
  name: space leviathan
  description: When the space becomes too quiet, there is no hope, there is no escape, but there is this.
  suffix: no despawn
  components:
  - type: Damageable
    damageModifierSet: Leviathan
    damageContainer: Biological
  - type: PointLight
    color: "#FF8227FF"
    radius: 3
    energy: 3
  - type: TailedEntity
    amount: 65
    spacing: 1
    prototype: SpaceWhaleSegment
  - type: MovementSpeedModifier
    baseSprintSpeed: 70
    baseWalkSpeed: 70
  - type: RadarBlip
    scale: 3
    shape: hexagon
    visibleFromOtherGrids: true
  - type: MovementIgnoreGravity
    gravityState: true
  - type: WarpPoint
    follow: true
    location: space leviathan
  - type: HTN
    sleepPlayerCheckRangeOverride: 1000
    blackboard:
      VisionRadius: !type:Single
        500
      AggroVisionRadius: !type:Single
        1000
      RotateSpeed: !type:Single
        3.141
    rootTask:
      task: LeviathanCompound
  - type: NpcFactionMember
    factions:
    - Dragon
  - type: Physics
  - type: Fixtures
    fixtures:
      fix1:
        shape:
          !type:PhysShapeCircle
          radius: 2
        density: 137992
        mask:
        - MobMask
        layer:
        - MobLayer
  - type: MeleeWeapon
    altDisarm: false
    attackRate: 0.3
    angle: 0
    animation: WeaponArcBite
    soundHit:
      path: /Audio/Effects/bite.ogg
    damage:
      types:
        Blunt: 50
        Slash: 45
        Structural: 800
  - type: Speech
    speechVerb: LargeMob
  - type: InteractionPopup
    interactSuccessString: petting-success-leviathan
    interactFailureString: petting-failure-leviathan
    interactFailureSound:
      path: /Audio/Effects/bite.ogg
  - type: Sprite
    sprite: _Exodus/Mobs/Monolith/leviathan.rsi
    state: head
    noRot: false
  - type: NightVision # Goobstation - Nigthvision
    color: "#808080"
    activateSound: null
    deactivateSound: null
  - type: AmbientSound
    enabled: true
    volume: 1
    range: 50
    sound:
      path: /Audio/_Exodus/Ambience/Leviathan/leviathan-ambient.ogg
  - type: MobThresholds
    thresholds:
      0: Alive
      8000: Dead
  - type: Destructible
    thresholds:
    - trigger:
        !type:DamageTrigger
        damage: 8000
      behaviors:
      - !type:GibBehavior
  - type: Tag
    tags:
    - SpaceLeviathan
  - type: DamageContacts
    damage:
      types:
        Structural: 4000
        Blunt: 10
    ignoreWhitelist:
      tags:
      - SpaceLeviathan

- type: entity
  id: SpaceWhaleSegment
  parent:
  - FlyingMobBase
  suffix: do not spawn
  components:
  - type: Damageable
    damageModifierSet: Leviathan
    damageContainer: Biological
  - type: PointLight
    color: "#FF8227FF"
    radius: 3
    energy: 1
  - type: RadarBlip
    scale: 2
    shape: diamond
    visibleFromOtherGrids: true
  - type: Sprite
    sprite: _Exodus/Mobs/Monolith/leviathan.rsi
    state: segment
    noRot: false
  - type: Tag
    tags:
    - SpaceLeviathan
    - HideContextMenu
  - type: Physics
    bodyType: KinematicController
  - type: Fixtures
    fixtures:
      fix1:
        shape:
          !type:PhysShapeCircle
          radius: 2
        mask:
        - MobMask
        layer:
        - MobLayer
  - type: DamageContacts
    damage:
      types:
        Structural: 2000
        Blunt: 10
    ignoreWhitelist:
      tags:
      - SpaceLeviathan

- type: entity
  id: SpaceLeviathanDespawn
  parent: SpaceLeviathan
  suffix: despawns
  components:
  - type: TimedDespawn
    lifetime: 300
